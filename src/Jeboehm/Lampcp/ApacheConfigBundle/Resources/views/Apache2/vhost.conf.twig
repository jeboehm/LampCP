##
#
# Generated by
#
# LampCP
# https://github.com/jeboehm/LampCP
#
# Licensed under the GPL Version 2 license
# http://www.gnu.org/licenses/gpl-2.0.txt
#
# PLEASE DO NOT CHANGE MANUALLY
# CHANGES WILL BE OVERWRITTEN
#
##

{% for ip in ips %}
    {% if ip.ip != "*" %}
        {% if ip.ipv6 %}
            NameVirtualHost [{{ ip.ip }}]:{{ ip.port }}
        {% else %}
            NameVirtualHost {{ ip.ip }}:{{ ip.port }}
        {% endif %}
    {% endif %}
{% endfor %}

{% for vhost in domains %}
    {% for ip in vhost.ipaddress %}
            {% if ip.ipv6 %}
                <VirtualHost [{{ ip.ip }}]:{{ ip.port }}>
            {% else %}
                <VirtualHost {{ ip.ip }}:{{ ip.port }}>
            {% endif %}

            ServerAdmin {{ vhost.serveradmin }}
            ServerName {{ vhost.servername }}
            ServerAlias {{ vhost.serveralias }}
            SuexecUserGroup {{ vhost.suexecuser }} {{ vhost.suexecgroup }}
            AddHandler fcgid-script .php
            DocumentRoot "{{ vhost.docroot }}"
            DirectoryIndex {{ vhost.directoryindex }}

            {% if ip.hasSsl and vhost.certificate is not null %}
                SSLEngine on
                SSLProtocol all -SSLv2
                SSLCipherSuite ALL:!ADH:!EXPORT:!SSLv2:RC4+RSA:+HIGH:+MEDIUM
                SSLCertificateFile /usr/local/apache/conf/ssl.crt
                SSLCertificateKeyFile /usr/local/apache/conf/ssl.key
                SSLCertificateChainFile /usr/local/apache/conf/sub.class1.server.ca.pem
                SSLCACertificateFile /usr/local/apache/conf/ca.pem
                SetEnvIf User-Agent ".*MSIE.*" nokeepalive ssl-unclean-shutdown
            {% endif %}

            <Directory "/">
                Options FollowSymLinks
                AllowOverride None
                Order allow,deny
                Deny from all
            </Directory>

            <Directory "{{ vhost.docroot }}">
                Options Indexes MultiViews FollowSymLinks +ExecCGI
                FCGIWrapper {{ vhost.fcgiwrapper }} .php
                Order allow,deny
                Allow from all
                AllowOverride all
            </Directory>

            ErrorLog {{ vhost.errorlog }}
            LogLevel warn
            CustomLog {{ vhost.customlog }} combined
            ServerSignature On
        </VirtualHost>

    {% endfor %}
{% endfor %}
